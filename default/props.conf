
[aws:cloudtrail]
EVAL-action = case(eventName=="ConsoleLogin", lower('responseElements.ConsoleLogin'), eventName=="TerminateInstances", "terminate", eventName=="RunInstances", "run", eventName=="StopInstances", "stop", eventName=="StartInstances", "start", eventName="GetObject", "get", eventName="PutObject", "put")
EVAL-status = if(eventName="RunInstances", 'responseElements.instancesSet.items{}.instanceState.name', 'responseElements.instancesSet.items{}.currentState.name')

# Rico mods for DM testing
FIELDALIAS-sourceIdentity.userName-for-cloud-dm = user AS src_user
FIELDALIAS-action-for-cloud-dm = eventName AS action
FIELDALIAS-event-for-cloud-dm = eventName AS event_name
FIELDALIAS-useragent-for-cloud-dm = userAgent AS http_user_agent
FIELDALIAS-aws-account-id-for-cloud-dm = aws_account_id AS account
FIELDALIAS-aws-arn-for-cloud-dm = userIdentity.arn AS resource_name
FIELDALIAS-aws-src-for-cloud-dm = src AS src_ip
FIELDALIAS-aws-image-id-for-cloud-dm = requestParameters.instancesSet.items{}.imageId AS image_id
FIELDALIAS-aws-error-code-for-cloud-dm = msg AS error_code
#FIELDALIAS-aws-status-for-cloud-dm = responseElements.instancesSet.items{}.currentState.name AS status
FIELDALIAS-dest-for-cloud-dm = responseElements.instancesSet.items{}.instanceId AS dest
FIELDALIAS-vendor-product-for-cloud-dm = eventSource AS vendor_product
FIELDALIAS-instance-type-for-cloud-dm = requestParameters.instanceType AS instance_type

#Storage
FIELDALIAS-bucket-name-for-cloud-dm = requestParameters.bucketName AS bucket_name


[google:gcp:pubsub:message]
###########################################
###     Field Aliases for Cloud DM      ###
###########################################

#COMPUTE
FIELDALIAS-operationType_action = "data.protoPayload.response.operationType" as action
FIELDALIAS-callerSuppliedUserAgent_http_user_agent = "callerSuppliedUserAgent" as http_user_agent
FIELDALIAS-region_zone = "data.resource.labels.zone" as region
FIELDALIAS-instance_id_resource_id = "data.resource.labels.instance_id" as resource_id
FIELDALIAS-resource_name = "data.labels.compute.googleapis.com/resource_name" as resource_name
FIELDALIAS-resource_name = "data.resource.type" as resource_name
FIELDALIAS-src_callerip = "data.protoPayload.requestMetadata.callerIp" as src
FIELDALIAS-request.networking_src_network = "data.protoPayload.request.networkinterfaces{}.accessConfigs{}.name" as src_network
FIELDALIAS-principalEmail_user_type = "data.protoPayload.authenticationInfo.principalEmail" as user_type
FIELDALIAS-actor_user_src_user = "data.jsonPayload.actor.user" as src_user
FIELDALIAS-account_principalemail = "data.protoPayload.authenticationInfo.principalEmail" as account
FIELDALIAS-instance_id_image_id = "data.protoPayload.response.targetId" as image_id
FIELDALIAS-event_name_event = "data.protoPayload.response.@Type" as event_name
FIELDALIAS-msg_message =  "data.jsonPayload.message" as msg
FIELDALIAS-status_msg = "data.protoPayload.response.status" AS status
#FIELDALIAS_dest_priority = "data.protoPayload.response.zone" as dest_priority


#STORAGE
FIELDALIAS-OperationType_action = "data.protoPayload.methodName" as action
FIELDALIAS-actor_user_account = "data.jsonPayload.actor.user" as account
FIELDALIAS-bucket_name = "data.resource.labels.bucket_name" as bucket_name
FIELDALIAS-callerSuppliedUserAgent_http_user_agent = "callerSuppliedUserAgent" as http_user_agent
#FIELDALIAS-event_name_event_type = "data.jsonPayload.event_type" as event_name
FIELDALIAS-resource_name = "data.resource.type" as resource_name
FIELDALIAS-src_callerip = "data.protoPayload.requestMetadata.callerIp" as src
FIELDALIAS-request.networking_src_network = "data.protoPayload.request.networkinterfaces{}.accessConfigs{}.name" as src_network
FIELDALIAS-actor_user_src_user = "data.jsonPayload.actor.user" as src_user
FIELDALIAS-msg_message =  "data.jsonPayload.message" as msg
FIELDALIAS-principalEmail_user_type = "data.protoPayload.authenticationInfo.principalEmail" as user_type
FIELDALIAS-path_object_path = "data.protoPayload.request.disks{}.initializeParams.sourceImage" as object_path
FIELDALIAS-region_info_zone = "data.resource.labels.zone" as region 
FIELDALIAS_storage_file_accessed = "data.protoPayload.authorizationInfo{}.resource" storage_resource

[mscs:azure:audit]                                                                                                                                                                                                       
############################################
#      Field Aliases for Cloud DM          #
############################################

#COMPUTE
#FIELDALIAS-operationName_act = "action" as action
FIELDALIAS-operationName_act = "operationName.localizedValue" as action
FIELDALIAS-status_stat = "status.value" as status
FIELDALIAS-providerName-resource = "resourceProviderName.value" as resource_name
FIELDALIAS-src-usr-for-dm = "claims.name" as src_user
FIELDALIAS-event_name-for-dm = "eventName.value" as event_name
FIELDALIAS-User-type-caller = "caller" as user_type
FIELDALIAS-src-ipp = "claims.ipaddr" as src
FIELDALIAS-msg-description = "eventName.localizedValue" as msg 
FIELDALIAS-region-location = "properties.resourceLocation" as region
FIELDALIAS-vendor-product-for-dm = "resourceProviderName.localizedValue" as vendor_product
FIELDALIAS-dest-for-dm = "resourceUri" as dest


#STORAGE
FIELDALIAS-objectPath-URI = "resourceUri" as object_path

