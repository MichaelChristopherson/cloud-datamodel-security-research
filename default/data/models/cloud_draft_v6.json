{
  "modelName": "Cloud_Draft_v6",
  "displayName": "Cloud Draft v6",
  "description": "Cloud Draft v6 Data Model",
  "editable": false,
  "objects": [
    {
      "comment": {
        "tags": [
          "cloud",
          "compute"
        ]
      },
      "objectName": "Compute",
      "displayName": "Compute",
      "parentName": "BaseSearch",
      "fields": [
        {   
          "comment": {
            "description": "The status of the instance.",
            "recommended": true
          },
          "fieldName": "status",
          "displayName": "status",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },  
        {   
          "comment": {
            "description": "The identifier for the image associated with the instance.",
            "recommended": true
          },
          "fieldName": "image_id",
          "displayName": "image_id",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },  
        {   
          "comment": {
            "description": "The type of the instance specified in dest.",
            "recommended": true
          },
          "fieldName": "instance_type",
          "displayName": "instance_type",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },  
        {   
          "comment": {
            "description": "The identifier for the event For AWS, this is the eventName",
            "recommended": true
          },
          "fieldName": "event_name",
          "displayName": "event_name",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },  
        {   
          "comment": {
            "description": "The return value for the request",
            "recommended": true
          },
          "fieldName": "msg",
          "displayName": "msg",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },  
        {
          "comment": {
            "description": "This is the region or geographical area in which the resource exists. For AWS, this is the awsRegion",
            "ta_relevant": true
          },
          "fieldName": "region",
          "displayName": "region",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        { 
          "comment": {
            "description": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons.",
            "ta_relevant": false
          },
          "fieldName": "dest_priority",
          "displayName": "dest_priority",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        { 
          "comment": {
            "description": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons.",
            "ta_relevant": false
          },
          "fieldName": "dest_requires_av",
          "displayName": "dest_requires_av",
          "type": "boolean",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        { 
          "comment": {
            "description": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons.",
            "ta_relevant": false
          },
          "fieldName": "dest_should_timesync",
          "displayName": "dest_should_timesync",
          "type": "boolean",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        { 
          "comment": {
            "description": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons.",
            "ta_relevant": false
          },
          "fieldName": "dest_should_update",
          "displayName": "dest_should_update",
          "type": "boolean",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "This is the resource name associated with the event. In AWS, this is the ARN",
            "ta_relevant": true
          },
          "fieldName": "resource_name",
          "displayName": "resource_name",
          "type": "string",
          "fieldSearch": "",
          "required": false,       
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "The type of user making the call. For AWS, some example values are AssumedRole, IAMUser, and AWSService",
            "recommended": true
          },
          "fieldName": "user_type",
          "displayName": "user_type",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "The user-agent used in the request."
          },
          "fieldName": "http_user_agent",
          "displayName": "http_user_agent",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "The source IP address of the request."
          },
          "fieldName": "src",
          "displayName": "src",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "The source network associated with the request."
          },
          "fieldName": "src_network",
          "displayName": "src_network",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "The action requested by the client for the compute resource."
          },
          "fieldName": "action",
          "displayName": "action",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "The name of the compute resource associated with the event."
          },
          "fieldName": "resource_id",
          "displayName": "resource_id",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons.",
            "ta_relevant": false
          },
          "fieldName": "dest_bunit",
          "displayName": "dest_bunit",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "This automatically generated field is used to access tags from within data models. Add-on builders do not need to populate it.",
            "ta_relevant": false
          },
          "fieldName": "tag",
          "displayName": "tag",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": true,
          "hidden": false
        },
        {
          "comment": {
            "description": "This field is used to identify the specific vendor product responsible for the event.",
            "ta_relevant": true
          },
          "fieldName": "vendor_product",
          "displayName": "vendor_product",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": true,
          "hidden": false
        }
      ],
      "calculations": [
        {
          "calculationID": "Cloud_compute_fillnull_src_user",
          "calculationType": "Eval",
          "outputFields": [
            {
              "comment": {
                "description": "In audit events, src_user represents the user who initiated the activity.",
                "recommended": true
              },
              "fieldName": "src_user",
              "displayName": "src_user",
              "type": "string",
              "fieldSearch": "",
              "required": false,
              "multivalue": false,
              "hidden": false
            }
          ],
          "expression": "if(isnull(src_user) OR src_user=\"\",\"unknown\",src_user)"
        },
        {
          "calculationID": "Cloud_compute_fillnull_dest",
          "calculationType": "Eval",
          "outputFields": [
            {
              "comment": {
                "description": "The instance on which the activity occurred.",
                "recommended": true
              },
              "fieldName": "dest",
              "displayName": "dest",
              "type": "string",
              "fieldSearch": "",
              "required": false,
              "multivalue": false,
              "hidden": false
            }
          ],
          "expression": "if(isnull(dest) OR dest=\"\",\"unknown\",dest)"
        },
        {   
          "calculationID": "Cloud_compute_fillnull_account",
          "calculationType": "Eval",
          "outputFields": [
            {
              "comment": {
                "description": "The account identifier for the cloud provider",
                "recommended": true
              },
              "fieldName": "account",
              "displayName": "account",
              "type": "string",
              "fieldSearch": "",
              "required": false,
              "multivalue": false,
              "hidden": false
            }  
          ],
          "expression": "if(isnull(account) OR account=\"\",\"unknown\",account)"
        }  
        {   
          "calculationID": "Cloud_compute_eval_vendor",
          "calculationType": "Eval",
          "outputFields": [
            {
              "comment": {
                "description": "This field is used to identify the cloud vendor responsible for the event.",
                "ta_relevant": true
              },
              "fieldName": "vendor",
              "displayName": "vendor",
              "type": "string",
              "fieldSearch": "",
              "required": false,
              "multivalue": true,
              "hidden": false
            }  
          ],
          "expression": "case(sourcetype=="*aws*", "aws", sourcetype=="*gcp*", gcp, sourcetype="*", "unknown")"
        }  
      ],
      "constraints": [

      ],
      "baseSearch": "(`cim_Cloud_indexes`) tag=cloud tag=compute",
      "children": [

      ]
    }, 
    {
      "comment": {
        "tags": [
          "cloud",
          "storage"
        ]
      },
      "objectName": "Storage",
      "displayName": "Storage",
      "parentName": "BaseSearch",
      "fields": [
        {   
          "comment": {
            "description": "The account identifier for the cloud provider",
            "recommended": true
          },
          "fieldName": "account",
          "displayName": "account",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },  
        {   
          "comment": {
            "description": "The identifier for the event For AWS, this is the eventName",
            "recommended": true
          },
          "fieldName": "event_name",
          "displayName": "event_name",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },  
        {   
          "comment": {
            "description": "The return value for the request",
            "recommended": true
          },
          "fieldName": "msg",
          "displayName": "msg",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },  
        {
          "comment": {
            "description": "This is the resource name associated with the event. In AWS, this is the ARN",
            "ta_relevant": true
          },
          "fieldName": "resource_name",
          "displayName": "resource_name",
          "type": "string",
          "fieldSearch": "",
          "required": false,       
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "This is the region or geographical area in which the resource exists. For AWS, this is the awsRegion",
            "ta_relevant": true
          },
          "fieldName": "region",
          "displayName": "region",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "The type of user making the call. For AWS, some example values are AssumedRole, IAMUser, and AWSService",
            "recommended": true
          },
          "fieldName": "user_type",
          "displayName": "user_type",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "The user-agent used in the request."
          },
          "fieldName": "http_user_agent",
          "displayName": "http_user_agent",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "The source IP address of the request."
          },
          "fieldName": "src",
          "displayName": "src",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "The source network associated with the request."
          },
          "fieldName": "src_network",
          "displayName": "src_network",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "This automatically generated field is used to access tags from within data models. Add-on builders do not need to populate it.",
            "ta_relevant": false
          },
          "fieldName": "tag",
          "displayName": "tag",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": true,
          "hidden": false
        },
        {
          "comment": {
            "description": "The action requested by the client."
          },
          "fieldName": "action",
          "displayName": "action",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "The name of the storage bucket associated with the request"
          },
          "fieldName": "bucket_name",
          "displayName": "bucket_name",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "This field displays the full path to the target object."
          },
          "fieldName": "object_path",
          "displayName": "object_path",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": false,
          "hidden": false
        },
        {
          "comment": {
            "description": "This automatically generated field is used to access tags from within data models. Add-on builders do not need to populate it.",
            "ta_relevant": false
          },
          "fieldName": "tag",
          "displayName": "tag",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": true,
          "hidden": false
        },
        {
          "comment": {
            "description": "This field is used to identify the cloud vendor responsible for the event.",
            "ta_relevant": true
          },
          "fieldName": "vendor",
          "displayName": "vendor",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": true,
          "hidden": false
        },
        {
          "comment": {
            "description": "This field is used to identify the specific vendor product responsible for the event.",
            "ta_relevant": true
          },
          "fieldName": "vendor_product",
          "displayName": "vendor_product",
          "type": "string",
          "fieldSearch": "",
          "required": false,
          "multivalue": true,
          "hidden": false
        }
      ],
      "calculations": [
        {
          "calculationID": "Cloud_storage_fillnull_src_user",
          "calculationType": "Eval",
          "outputFields": [
            {
              "comment": {
                "description": "In audit events, src_user represents the user who initiated the activity.",
                "recommended": true
              },
              "fieldName": "src_user",
              "displayName": "src_user",
              "type": "string",
              "fieldSearch": "",
              "required": false,
              "multivalue": false,
              "hidden": false
            }
          ],
          "expression": "if(isnull(src_user) OR src_user=\"\",\"unknown\",src_user)"
        }
      ],
      "constraints": [

      ],
      "baseSearch": "(`cim_Cloud_indexes`) tag=cloud tag=storage",
      "children": [
        
      ]
    }
  ]
}
